<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TInputLit - Component Demo</title>
    <script src="../js/utils/accent-init.js"></script>
    <link rel="stylesheet" href="../css/demo-template.css">

    <style>
        .message {
            font-size: 11px;
            margin-top: 8px;
        }
        .message.error { color: var(--terminal-red, #ff3333); }
        .message.success { color: var(--terminal-green, #00ff41); }
        .message.warning { color: var(--terminal-amber, #ffb000); }
        .message.info { color: var(--terminal-green-dim, #00cc33); }

        .warning-input-wrapper t-inp input {
            border-color: var(--terminal-amber) !important;
            color: var(--terminal-amber) !important;
        }

        .button-row {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <!-- Fixed Header -->
    <header class="demo-header">
        <div class="demo-header-content">
            <div class="demo-header-left">
                <h1>TInputLit</h1>
                <div class="breadcrumb">
                    <a href="index.html">← Components</a> / Input
                </div>
            </div>
            <div class="demo-header-controls">
                <button class="header-btn" id="toggleLogBtn">▼ Event Log</button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="demo-container">
        <div class="component-section">
            <h2 class="component-title">Text Inputs</h2>
            <p class="component-description">
                Terminal-styled input fields with built-in validation, character counting, and various input types.
            </p>

            <h3>Live Validation</h3>
            <div class="demo-grid">
                <div class="demo-item">
                    <span class="demo-label">Character Counter</span>
                    <t-inp id="charInput" type="text" placeholder="Type something..." maxlength="50"></t-inp>
                    <div id="charCount" class="message info">0 / 50 characters</div>
                </div>

                <div class="demo-item">
                    <span class="demo-label">Email Validation</span>
                    <t-inp id="emailInput" type="email" placeholder="user@example.com"></t-inp>
                    <div id="emailMsg" class="message info">Enter a valid email address</div>
                </div>

                <div class="demo-item">
                    <span class="demo-label">URL Validation</span>
                    <t-inp id="urlInput" type="url" placeholder="https://example.com"></t-inp>
                    <div id="urlMsg" class="message info">Enter a valid URL</div>
                </div>

                <div class="demo-item">
                    <span class="demo-label">Letters Only (Pattern)</span>
                    <t-inp id="patternInput" type="text" placeholder="Letters only" pattern="^[A-Za-z ]*$"></t-inp>
                    <div id="patternMsg" class="message info">Only letters allowed</div>
                </div>

                <div class="demo-item">
                    <span class="demo-label">Number Range (0-100)</span>
                    <t-inp id="rangeInput" type="number" placeholder="0-100" min="0" max="100"></t-inp>
                    <div id="rangeMsg" class="message info">Enter number between 0-100</div>
                </div>

                <div class="demo-item">
                    <span class="demo-label">Dynamic Error (type "error")</span>
                    <t-inp id="errorInput" type="text" placeholder="Type 'error' to trigger"></t-inp>
                    <div id="errorMsg" class="message info">Type "error" to see error state</div>
                </div>
            </div>

            <h3>Form Fields</h3>
            <div class="demo-grid">
                <div class="demo-item">
                    <span class="demo-label">Required Field</span>
                    <form id="reqForm" novalidate>
                        <t-inp id="reqInput" type="text" placeholder="Required field" required></t-inp>
                        <div class="button-row">
                            <t-btn id="reqSubmit" variant="primary" size="small">Submit</t-btn>
                        </div>
                        <div id="reqMsg" class="message"></div>
                    </form>
                </div>

                <div class="demo-item">
                    <span class="demo-label">Password with Strength</span>
                    <t-inp id="passwordInput" type="password" placeholder="Enter password" minlength="8"></t-inp>
                    <div id="passwordMsg" class="message info">Minimum 8 characters</div>
                </div>

                <div class="demo-item">
                    <span class="demo-label">Warning State</span>
                    <div class="warning-input-wrapper">
                        <t-inp id="warnInput" type="text" value="Warning value"></t-inp>
                    </div>
                    <div class="message warning">
                        <span id="warnIcon"></span> This value may cause issues
                    </div>
                </div>

                <div class="demo-item">
                    <span class="demo-label">Disabled Input</span>
                    <t-inp type="text" value="Cannot edit" disabled></t-inp>
                </div>
            </div>

            <h3>Number Stepper Variants</h3>
            <div class="demo-grid">
                <div class="demo-item">
                    <span class="demo-label">Plus/Minus</span>
                    <t-inp type="number" value="42" min="0" max="100" stepper-style="plusminus"></t-inp>
                </div>

                <div class="demo-item">
                    <span class="demo-label">Chevron</span>
                    <t-inp type="number" value="12" min="-50" max="50" stepper-style="chevron"></t-inp>
                </div>

                <div class="demo-item">
                    <span class="demo-label">Arrows</span>
                    <t-inp type="number" value="7" min="0" max="20" stepper-style="arrows"></t-inp>
                </div>

                <div class="demo-item">
                    <span class="demo-label">Size Small</span>
                    <t-inp type="number" value="8" min="0" max="99" stepper-size="sm"></t-inp>
                </div>

                <div class="demo-item">
                    <span class="demo-label">Size Regular</span>
                    <t-inp type="number" value="42" min="0" max="999"></t-inp>
                </div>

                <div class="demo-item">
                    <span class="demo-label">Size Large</span>
                    <t-inp type="number" value="128" min="0" max="999" stepper-size="lg"></t-inp>
                </div>
            </div>

            <div class="code-block">
                <code>&lt;!-- Basic input --&gt;
&lt;t-inp type="text" placeholder="Enter text"&gt;&lt;/t-inp&gt;

&lt;!-- Email with validation --&gt;
&lt;t-inp type="email" placeholder="user@example.com"&gt;&lt;/t-inp&gt;

&lt;!-- Password input --&gt;
&lt;t-inp type="password" placeholder="Password" minlength="8"&gt;&lt;/t-inp&gt;

&lt;!-- Number with range --&gt;
&lt;t-inp type="number" min="0" max="100"&gt;&lt;/t-inp&gt;

&lt;!-- Pattern validation --&gt;
&lt;t-inp type="text" pattern="^[A-Za-z]*$"&gt;&lt;/t-inp&gt;

&lt;!-- Required field --&gt;
&lt;t-inp type="text" required&gt;&lt;/t-inp&gt;

&lt;!-- JavaScript API --&gt;
&lt;script&gt;
  const input = document.querySelector('t-inp');
  input.getValue();           // Get current value
  input.setValue('new text'); // Set value
  input.validate();           // Trigger validation
  input.setError(true, 'Custom error message');

  // Events
  input.addEventListener('input-value', (e) =&gt; {
    console.log('Value:', e.detail.value);
  });
  input.addEventListener('input-valid', () =&gt; {});
  input.addEventListener('input-error', (e) =&gt; {
    console.log('Error:', e.detail.message);
  });
&lt;/script&gt;</code>
            </div>
        </div>
    </div>

    <!-- Floating Event Log -->
    <div class="event-log-container collapsed" id="eventLogContainer">
        <div class="event-log-toggle">
            <h3><span class="toggle-icon">▲</span> Event Log</h3>
            <div class="event-log-controls">
                <span class="event-log-count">0</span>
                <button class="event-log-clear">Clear</button>
            </div>
        </div>
        <div class="event-log" id="eventLog"></div>
    </div>

    <script type="module">
        import '../js/components/TInputLit.js';
        import '../js/components/TButtonLit.js';
        import { warningIcon } from '../js/utils/phosphor-icons.js';

        // Event log functionality
        let eventCount = 0;
        const eventLog = document.getElementById('eventLog');
        const eventLogContainer = document.getElementById('eventLogContainer');
        const countEl = document.querySelector('.event-log-count');
        const toggleLogBtn = document.getElementById('toggleLogBtn');

        function logEvent(component, event, detail) {
            const entry = document.createElement('div');
            entry.className = 'event-entry';
            const timestamp = new Date().toLocaleTimeString();
            entry.textContent = `[${timestamp}] ${component}: ${event}${detail ? ' - ' + JSON.stringify(detail) : ''}`;
            eventLog.appendChild(entry);
            eventLog.scrollTop = eventLog.scrollHeight;
            eventCount++;
            countEl.textContent = eventCount;
        }

        // Toggle event log
        document.querySelector('.event-log-toggle').addEventListener('click', (e) => {
            if (e.target.closest('.event-log-clear')) return;
            eventLogContainer.classList.toggle('collapsed');
            toggleLogBtn.classList.toggle('active');
        });

        toggleLogBtn.addEventListener('click', () => {
            eventLogContainer.classList.toggle('collapsed');
            toggleLogBtn.classList.toggle('active');
        });

        // Clear log
        document.querySelector('.event-log-clear').addEventListener('click', (e) => {
            e.stopPropagation();
            eventLog.innerHTML = '';
            eventCount = 0;
            countEl.textContent = '0';
        });

        window.addEventListener('DOMContentLoaded', () => {
            // Warning icon
            const warnIconEl = document.getElementById('warnIcon');
            if (warnIconEl) {
                warnIconEl.innerHTML = warningIcon;
                const svg = warnIconEl.querySelector('svg');
                if (svg) {
                    svg.style.width = '14px';
                    svg.style.height = '14px';
                    svg.style.verticalAlign = 'middle';
                    svg.style.marginRight = '4px';
                    svg.style.fill = 'var(--terminal-amber)';
                }
            }

            // Character Counter
            const charInput = document.getElementById('charInput');
            const charCount = document.getElementById('charCount');
            if (charInput && charCount) {
                charInput.addEventListener('input-value', (e) => {
                    const len = e.detail.value.length;
                    charCount.textContent = `${len} / 50 characters`;
                    charCount.className = len > 50 ? 'message error' : len >= 40 ? 'message warning' : 'message info';
                    logEvent('charInput', 'input-value', { length: len });
                });
            }

            // Email
            const emailInput = document.getElementById('emailInput');
            const emailMsg = document.getElementById('emailMsg');
            if (emailInput && emailMsg) {
                emailInput.addEventListener('input-error', (e) => {
                    emailMsg.textContent = e.detail?.message || 'Invalid email';
                    emailMsg.className = 'message error';
                    logEvent('emailInput', 'input-error', { message: e.detail?.message });
                });
                emailInput.addEventListener('input-valid', () => {
                    const val = emailInput.getValue() || '';
                    emailMsg.textContent = val ? 'Valid email' : 'Enter a valid email address';
                    emailMsg.className = val ? 'message success' : 'message info';
                    if (val) logEvent('emailInput', 'input-valid');
                });
            }

            // URL
            const urlInput = document.getElementById('urlInput');
            const urlMsg = document.getElementById('urlMsg');
            if (urlInput && urlMsg) {
                urlInput.addEventListener('input-error', (e) => {
                    urlMsg.textContent = e.detail?.message || 'Invalid URL';
                    urlMsg.className = 'message error';
                    logEvent('urlInput', 'input-error');
                });
                urlInput.addEventListener('input-valid', () => {
                    const val = urlInput.getValue() || '';
                    urlMsg.textContent = val ? 'Valid URL' : 'Enter a valid URL';
                    urlMsg.className = val ? 'message success' : 'message info';
                    if (val) logEvent('urlInput', 'input-valid');
                });
            }

            // Pattern
            const patternInput = document.getElementById('patternInput');
            const patternMsg = document.getElementById('patternMsg');
            if (patternInput && patternMsg) {
                patternInput.addEventListener('input-error', () => {
                    patternMsg.textContent = 'Only letters and spaces allowed';
                    patternMsg.className = 'message error';
                    logEvent('patternInput', 'input-error');
                });
                patternInput.addEventListener('input-valid', () => {
                    const val = patternInput.getValue() || '';
                    patternMsg.textContent = val ? 'Valid input' : 'Only letters allowed';
                    patternMsg.className = val ? 'message success' : 'message info';
                    if (val) logEvent('patternInput', 'input-valid');
                });
            }

            // Number range
            const rangeInput = document.getElementById('rangeInput');
            const rangeMsg = document.getElementById('rangeMsg');
            if (rangeInput && rangeMsg) {
                rangeInput.addEventListener('input-error', (e) => {
                    rangeMsg.textContent = e.detail?.message || 'Invalid number';
                    rangeMsg.className = 'message error';
                    logEvent('rangeInput', 'input-error');
                });
                rangeInput.addEventListener('input-valid', () => {
                    const val = rangeInput.getValue();
                    rangeMsg.textContent = val !== '' ? `Valid (${val})` : 'Enter number between 0-100';
                    rangeMsg.className = val !== '' ? 'message success' : 'message info';
                    if (val !== '') logEvent('rangeInput', 'input-valid', { value: val });
                });
            }

            // Dynamic Error
            const errorInput = document.getElementById('errorInput');
            const errorMsg = document.getElementById('errorMsg');
            if (errorInput && errorMsg) {
                errorInput.addEventListener('input-value', (e) => {
                    const value = (e.detail.value || '').toLowerCase();
                    if (value === 'error') {
                        errorInput.setError(true, 'Error state triggered!');
                        errorMsg.textContent = 'Error state triggered!';
                        errorMsg.className = 'message error';
                        logEvent('errorInput', 'error-triggered');
                    } else {
                        errorInput.setError(false);
                        errorMsg.textContent = value ? 'Keep typing...' : 'Type "error" to see error state';
                        errorMsg.className = 'message info';
                    }
                });
            }

            // Required field
            const reqForm = document.getElementById('reqForm');
            const reqInput = document.getElementById('reqInput');
            const reqSubmit = document.getElementById('reqSubmit');
            const reqMsg = document.getElementById('reqMsg');
            if (reqForm && reqInput && reqSubmit && reqMsg) {
                reqForm.addEventListener('submit', (e) => e.preventDefault());
                reqSubmit.addEventListener('button-click', () => {
                    if (reqInput.validate()) {
                        reqMsg.textContent = 'Form submitted successfully!';
                        reqMsg.className = 'message success';
                        logEvent('reqForm', 'submit-success');
                    } else {
                        reqMsg.textContent = 'This field is required';
                        reqMsg.className = 'message error';
                        logEvent('reqForm', 'submit-failed');
                    }
                });
            }

            // Password
            const passwordInput = document.getElementById('passwordInput');
            const passwordMsg = document.getElementById('passwordMsg');
            if (passwordInput && passwordMsg) {
                passwordInput.addEventListener('input-value', (e) => {
                    const value = e.detail?.value || '';
                    if (value.length === 0) {
                        passwordMsg.textContent = 'Minimum 8 characters';
                        passwordMsg.className = 'message info';
                    } else if (value.length < 8) {
                        passwordMsg.textContent = `Too short (${value.length}/8)`;
                        passwordMsg.className = 'message error';
                    } else {
                        const hasUpper = /[A-Z]/.test(value);
                        const hasLower = /[a-z]/.test(value);
                        const hasNumber = /[0-9]/.test(value);
                        const hasSpecial = /[^A-Za-z0-9]/.test(value);
                        const strength = [hasUpper, hasLower, hasNumber, hasSpecial].filter(Boolean).length;

                        if (strength === 4) {
                            passwordMsg.textContent = 'Strong password';
                            passwordMsg.className = 'message success';
                        } else if (strength >= 2) {
                            passwordMsg.textContent = 'Valid (could be stronger)';
                            passwordMsg.className = 'message warning';
                        } else {
                            passwordMsg.textContent = 'Valid length';
                            passwordMsg.className = 'message info';
                        }
                        passwordInput.setError(false);
                    }
                });
            }

            logEvent('System', 'Demo initialized');
        });
    </script>
    <script type="module" src="../js/utils/demo-color-picker.js"></script>
</body>
</html>
