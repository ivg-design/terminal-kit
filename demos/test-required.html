<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Required Field</title>

    <!-- Core styles -->
    <link rel="stylesheet" href="../css/theme/terminal.css">
    <link rel="stylesheet" href="../css/components/form.css">
    <link rel="stylesheet" href="../css/components/button.css">

    <style>
        body {
            font-family: 'SF Mono', 'Monaco', monospace;
            background: #0a0a0a;
            color: #00ff41;
            padding: 40px;
        }

        .test-container {
            max-width: 600px;
            margin: 0 auto;
            padding: 30px;
            background: #1a1a1a;
            border: 1px solid #333333;
        }

        h2 {
            margin-bottom: 20px;
        }

        .test-group {
            margin-bottom: 30px;
        }

        .message {
            margin-top: 10px;
            font-size: 12px;
        }

        .message.error {
            color: #ff3333;
        }

        .message.success {
            color: #00ff41;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h2>Required Field Test</h2>

        <div class="test-group">
            <h3>Test 1: Component Structure</h3>
            <terminal-input id="testInput" type="text" placeholder="Required field" required></terminal-input>
            <button id="inspectBtn">Inspect DOM Structure</button>
            <pre id="domStructure"></pre>
        </div>

        <div class="test-group">
            <h3>Test 2: Validation Test</h3>
            <terminal-input id="reqInput" type="text" placeholder="Required field" required></terminal-input>
            <button id="validateBtn">Validate</button>
            <div id="result" class="message"></div>
        </div>

        <div class="test-group">
            <h3>Test 3: Direct Style Application</h3>
            <terminal-input id="styleInput" type="text" placeholder="Test field" required></terminal-input>
            <button id="applyStyleBtn">Apply Error Style Directly</button>
        </div>
    </div>

    <script type="module">
        import '../js/components/TerminalComponent.js';
        import '../js/components/TerminalInput.js';
        import '../js/components/TerminalButton.js';

        window.addEventListener('DOMContentLoaded', () => {
            // Test 1: Inspect DOM Structure
            const inspectBtn = document.getElementById('inspectBtn');
            const domStructure = document.getElementById('domStructure');
            const testInput = document.getElementById('testInput');

            inspectBtn.addEventListener('click', () => {
                const structure = {
                    tagName: testInput.tagName,
                    innerHTML: testInput.innerHTML.substring(0, 200) + '...',
                    hasForm: !!testInput.querySelector('form'),
                    hasInput: !!testInput.querySelector('input'),
                    formClasses: testInput.querySelector('form')?.className,
                    inputClasses: testInput.querySelector('input')?.className,
                    inputStyles: testInput.querySelector('input')?.style.cssText,
                };
                domStructure.textContent = JSON.stringify(structure, null, 2);
            });

            // Test 2: Validation Test
            const validateBtn = document.getElementById('validateBtn');
            const reqInput = document.getElementById('reqInput');
            const result = document.getElementById('result');

            validateBtn.addEventListener('click', () => {
                const isValid = reqInput.validate();
                result.textContent = isValid ? '✓ Valid' : '✗ Invalid';
                result.className = 'message ' + (isValid ? 'success' : 'error');

                // Log current state
                console.log('After validation:');
                console.log('- Form classes:', reqInput.querySelector('form')?.className);
                console.log('- Input classes:', reqInput.querySelector('input')?.className);
                console.log('- Input styles:', reqInput.querySelector('input')?.style.cssText);
                console.log('- Computed border:', window.getComputedStyle(reqInput.querySelector('input')).borderColor);
            });

            // Test 3: Direct Style Application
            const applyStyleBtn = document.getElementById('applyStyleBtn');
            const styleInput = document.getElementById('styleInput');

            applyStyleBtn.addEventListener('click', () => {
                const form = styleInput.querySelector('form');
                const input = styleInput.querySelector('input');

                if (form && input) {
                    // Apply same styles that setError should apply
                    form.classList.add('error');
                    input.classList.add('error');
                    input.style.setProperty('border-color', '#ff3333', 'important');
                    input.style.setProperty('color', '#ff3333', 'important');

                    console.log('Styles applied directly:');
                    console.log('- Form classes:', form.className);
                    console.log('- Input classes:', input.className);
                    console.log('- Input styles:', input.style.cssText);
                    console.log('- Computed border:', window.getComputedStyle(input).borderColor);
                }
            });
        });
    </script>
</body>
</html>