<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TChartLit - Component Demo</title>
    <script src="../js/utils/accent-init.js"></script>
    <link rel="stylesheet" href="../css/demo-template.css">

    <style>
        /* Charts fill their grid cell */
        .demo-grid t-chart {
            width: 100%;
        }
        /* Wide grids should show charts at reasonable size */
        .demo-grid.wide t-chart {
            max-width: 600px;
        }
    </style>
</head>
<body>
    <!-- Fixed Header -->
    <header class="demo-header">
        <div class="demo-header-content">
            <div class="demo-header-left">
                <h1>TChartLit</h1>
                <div class="breadcrumb">
                    <a href="index.html">← Components</a> / Chart
                </div>
            </div>
            <div class="demo-header-controls">
                <button class="header-btn" id="toggleLogBtn">▼ Event Log</button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="demo-container">
        <div class="component-section">
            <h2 class="component-title">Chart Component</h2>
            <p class="component-description">
                Simple data visualizations with bar, line, pie, and donut chart types.
            </p>

            <h3>Bar Chart</h3>
            <div class="demo-grid wide">
                <div class="demo-item">
                    <t-chart id="bar-chart" type="bar" title="Monthly Revenue" height="220px" show-legend></t-chart>
                </div>
            </div>

            <h3>Line Chart</h3>
            <div class="demo-grid wide">
                <div class="demo-item">
                    <t-chart id="line-chart" type="line" title="Daily Active Users" height="220px"></t-chart>
                </div>
            </div>

            <h3>Pie & Donut Charts</h3>
            <div class="demo-grid">
                <div class="demo-item">
                    <t-chart id="pie-chart" type="pie" title="Market Share" height="220px" show-legend></t-chart>
                    <span class="demo-label">Pie Chart</span>
                </div>
                <div class="demo-item">
                    <t-chart id="donut-chart" type="donut" title="Resource Usage" height="220px" show-legend></t-chart>
                    <span class="demo-label">Donut Chart</span>
                </div>
            </div>

            <h3>Minimal Style</h3>
            <div class="demo-grid wide">
                <div class="demo-item">
                    <span class="demo-label">No Grid/Labels</span>
                    <t-chart id="minimal-chart" type="bar" title="Clean View" height="180px"></t-chart>
                </div>
            </div>

            <h3>Custom Colors</h3>
            <div class="demo-grid wide">
                <div class="demo-item">
                    <t-chart id="custom-colors-chart" type="bar" title="Quarterly Results" height="200px"></t-chart>
                </div>
            </div>

            <h3>Monochrome Mode</h3>
            <div class="demo-grid">
                <div class="demo-item">
                    <t-chart id="mono-green-chart" type="pie" title="Green Monochrome" height="200px" monochrome base-color="#00ff41" show-legend></t-chart>
                    <span class="demo-label">Base: Green</span>
                </div>
                <div class="demo-item">
                    <t-chart id="mono-cyan-chart" type="donut" title="Cyan Monochrome" height="200px" monochrome base-color="#00ffff" show-legend></t-chart>
                    <span class="demo-label">Base: Cyan</span>
                </div>
                <div class="demo-item">
                    <t-chart id="mono-amber-chart" type="bar" title="Amber Monochrome" height="200px" monochrome base-color="#ffb000"></t-chart>
                    <span class="demo-label">Base: Amber</span>
                </div>
            </div>

            <h3>Color Schemes</h3>
            <div class="demo-grid wide">
                <div class="demo-item">
                    <span class="demo-label">Click to change scheme</span>
                    <div class="controls" style="margin-bottom: 15px;">
                        <button onclick="setScheme('terminal')">Terminal</button>
                        <button onclick="setScheme('neon')">Neon</button>
                        <button onclick="setScheme('cool')">Cool</button>
                        <button onclick="setScheme('warm')">Warm</button>
                        <button onclick="setScheme('grayscale')">Grayscale</button>
                        <button onclick="setScheme('mono-green')">Mono Green</button>
                        <button onclick="setScheme('mono-cyan')">Mono Cyan</button>
                        <button onclick="setScheme('mono-amber')">Mono Amber</button>
                    </div>
                    <t-chart id="scheme-chart" type="bar" title="Color Scheme Demo" height="220px" show-legend></t-chart>
                </div>
            </div>

            <h3>Outline Only Mode</h3>
            <div class="demo-grid">
                <div class="demo-item">
                    <t-chart id="outline-chart" type="bar" title="Outline Bars" height="200px" outline-only monochrome base-color="#00ff41"></t-chart>
                    <span class="demo-label">outline-only monochrome</span>
                </div>
                <div class="demo-item">
                    <t-chart id="outline-chart-multi" type="bar" title="Outline Colors" height="200px" outline-only color-scheme="terminal"></t-chart>
                    <span class="demo-label">outline-only with colors</span>
                </div>
            </div>

            <h3>Interactive Demo</h3>
            <div class="demo-grid wide">
                <div class="demo-item">
                    <span class="demo-label">Control with buttons</span>
                    <div class="controls" style="margin-bottom: 15px;">
                        <button onclick="setChartType('bar')">Bar</button>
                        <button onclick="setChartType('line')">Line</button>
                        <button onclick="setChartType('pie')">Pie</button>
                        <button onclick="setChartType('donut')">Donut</button>
                        <button onclick="toggleLegend()">Toggle Legend</button>
                        <button onclick="toggleGrid()">Toggle Grid</button>
                        <button onclick="randomizeData()">Randomize Data</button>
                    </div>
                    <t-chart id="interactive-chart" type="bar" title="Interactive Chart" height="250px" show-legend></t-chart>
                </div>
            </div>

            <h3>Real-time Updates</h3>
            <div class="demo-grid wide">
                <div class="demo-item">
                    <span class="demo-label">Live data feed</span>
                    <div class="controls" style="margin-bottom: 15px;">
                        <button id="start-btn" onclick="startRealtime()">Start Updates</button>
                        <button id="stop-btn" onclick="stopRealtime()" disabled>Stop Updates</button>
                    </div>
                    <t-chart id="realtime-chart" type="line" title="Live Data Feed" height="200px"></t-chart>
                </div>
            </div>

            <div class="code-block">
                <code>&lt;!-- Basic chart --&gt;
&lt;t-chart type="bar" title="My Chart"&gt;&lt;/t-chart&gt;

&lt;!-- Chart types --&gt;
&lt;t-chart type="line"&gt;&lt;/t-chart&gt;
&lt;t-chart type="pie"&gt;&lt;/t-chart&gt;
&lt;t-chart type="donut"&gt;&lt;/t-chart&gt;

&lt;!-- With options --&gt;
&lt;t-chart type="bar" show-legend show-grid&gt;&lt;/t-chart&gt;

&lt;!-- Monochrome --&gt;
&lt;t-chart type="pie" monochrome base-color="#00ff41"&gt;&lt;/t-chart&gt;

&lt;!-- JavaScript API --&gt;
&lt;script&gt;
  const chart = document.querySelector('t-chart');
  chart.setData([
    { label: 'Jan', value: 100 },
    { label: 'Feb', value: 200 }
  ]);
  chart.addEventListener('segment-click', (e) =&gt; {});
&lt;/script&gt;</code>
            </div>
        </div>
    </div>

    <!-- Floating Event Log -->
    <div class="event-log-container collapsed" id="eventLogContainer">
        <div class="event-log-toggle">
            <h3><span class="toggle-icon">▲</span> Event Log</h3>
            <div class="event-log-controls">
                <span class="event-log-count">0</span>
                <button class="event-log-clear">Clear</button>
            </div>
        </div>
        <div class="event-log" id="eventLog"></div>
    </div>

    <script type="module">
        import '../js/components/TChartLit.js';

        // Event log functionality
        let eventCount = 0;
        const eventLog = document.getElementById('eventLog');
        const eventLogContainer = document.getElementById('eventLogContainer');
        const countEl = document.querySelector('.event-log-count');
        const toggleLogBtn = document.getElementById('toggleLogBtn');

        function logEvent(component, event, detail) {
            const entry = document.createElement('div');
            entry.className = 'event-entry';
            const timestamp = new Date().toLocaleTimeString();
            entry.textContent = `[${timestamp}] ${component}: ${event}${detail ? ' - ' + JSON.stringify(detail) : ''}`;
            eventLog.appendChild(entry);
            eventLog.scrollTop = eventLog.scrollHeight;
            eventCount++;
            countEl.textContent = eventCount;
        }

        // Toggle event log
        document.querySelector('.event-log-toggle').addEventListener('click', (e) => {
            if (e.target.closest('.event-log-clear')) return;
            eventLogContainer.classList.toggle('collapsed');
            toggleLogBtn.classList.toggle('active');
        });

        toggleLogBtn.addEventListener('click', () => {
            eventLogContainer.classList.toggle('collapsed');
            toggleLogBtn.classList.toggle('active');
        });

        // Clear log
        document.querySelector('.event-log-clear').addEventListener('click', (e) => {
            e.stopPropagation();
            eventLog.innerHTML = '';
            eventCount = 0;
            countEl.textContent = '0';
        });

        // Sample data
        const monthlyData = [
            { label: 'Jan', value: 4200 },
            { label: 'Feb', value: 3800 },
            { label: 'Mar', value: 5100 },
            { label: 'Apr', value: 4600 },
            { label: 'May', value: 5800 },
            { label: 'Jun', value: 6200 }
        ];

        const dailyData = [
            { label: 'Mon', value: 1200 },
            { label: 'Tue', value: 1400 },
            { label: 'Wed', value: 1350 },
            { label: 'Thu', value: 1600 },
            { label: 'Fri', value: 1800 },
            { label: 'Sat', value: 900 },
            { label: 'Sun', value: 750 }
        ];

        const marketData = [
            { label: 'Product A', value: 35 },
            { label: 'Product B', value: 25 },
            { label: 'Product C', value: 20 },
            { label: 'Product D', value: 12 },
            { label: 'Other', value: 8 }
        ];

        const resourceData = [
            { label: 'CPU', value: 45, color: '#00ff41' },
            { label: 'Memory', value: 30, color: '#00ffff' },
            { label: 'Storage', value: 15, color: '#ffb000' },
            { label: 'Network', value: 10, color: '#ff003c' }
        ];

        // Set up charts
        document.getElementById('bar-chart').setData(monthlyData);
        document.getElementById('line-chart').setData(dailyData);
        document.getElementById('pie-chart').setData(marketData);
        document.getElementById('donut-chart').setData(resourceData);

        // Minimal chart
        const minimalChart = document.getElementById('minimal-chart');
        minimalChart.showGrid = false;
        minimalChart.showLabels = false;
        minimalChart.setData(monthlyData);

        // Custom colors chart
        const customChart = document.getElementById('custom-colors-chart');
        customChart.colors = ['#ff003c', '#ffb000', '#00ffff', '#9d00ff'];
        customChart.setData([
            { label: 'Q1', value: 4500 },
            { label: 'Q2', value: 5200 },
            { label: 'Q3', value: 4800 },
            { label: 'Q4', value: 6100 }
        ]);

        // Monochrome charts
        const monoData = [
            { label: 'A', value: 35 },
            { label: 'B', value: 25 },
            { label: 'C', value: 20 },
            { label: 'D', value: 12 },
            { label: 'E', value: 8 }
        ];
        document.getElementById('mono-green-chart').setData(monoData);
        document.getElementById('mono-cyan-chart').setData(monoData);
        document.getElementById('mono-amber-chart').setData(monoData);

        // Color scheme chart
        const schemeChart = document.getElementById('scheme-chart');
        const schemeData = [
            { label: 'Category A', value: 4200 },
            { label: 'Category B', value: 3800 },
            { label: 'Category C', value: 5100 },
            { label: 'Category D', value: 4600 },
            { label: 'Category E', value: 5800 },
            { label: 'Category F', value: 3200 }
        ];
        schemeChart.setData(schemeData);

        // Outline charts
        document.getElementById('outline-chart').setData(monthlyData);
        document.getElementById('outline-chart-multi').setData(monthlyData);

        window.setScheme = (scheme) => {
            schemeChart.colorScheme = scheme;
            logEvent('scheme-chart', 'colorScheme', { scheme });
        };

        // Interactive chart
        const interactiveChart = document.getElementById('interactive-chart');
        let interactiveData = [...monthlyData];
        interactiveChart.setData(interactiveData);

        window.setChartType = (type) => {
            interactiveChart.type = type;
            logEvent('interactive', 'type', { type });
        };

        window.toggleLegend = () => {
            interactiveChart.showLegend = !interactiveChart.showLegend;
            logEvent('interactive', 'showLegend', { showLegend: interactiveChart.showLegend });
        };

        window.toggleGrid = () => {
            interactiveChart.showGrid = !interactiveChart.showGrid;
            logEvent('interactive', 'showGrid', { showGrid: interactiveChart.showGrid });
        };

        window.randomizeData = () => {
            interactiveData = interactiveData.map(item => ({
                ...item,
                value: Math.floor(Math.random() * 5000) + 1000
            }));
            interactiveChart.setData(interactiveData);
            logEvent('interactive', 'randomize');
        };

        // Real-time chart
        const realtimeChart = document.getElementById('realtime-chart');
        let realtimeData = [];
        let realtimeInterval = null;
        let counter = 0;

        function initRealtimeData() {
            realtimeData = [];
            counter = 0;
            for (let i = 0; i < 10; i++) {
                realtimeData.push({
                    label: `T${counter++}`,
                    value: Math.floor(Math.random() * 100) + 50
                });
            }
            realtimeChart.setData(realtimeData);
        }

        initRealtimeData();

        window.startRealtime = () => {
            document.getElementById('start-btn').disabled = true;
            document.getElementById('stop-btn').disabled = false;
            logEvent('realtime', 'start');

            realtimeInterval = setInterval(() => {
                realtimeData.shift();
                const newValue = Math.floor(Math.random() * 100) + 50;
                realtimeData.push({
                    label: `T${counter++}`,
                    value: newValue
                });
                realtimeChart.setData([...realtimeData]);
                logEvent('realtime', 'update', { label: `T${counter - 1}`, value: newValue });
            }, 1000);
        };

        window.stopRealtime = () => {
            document.getElementById('start-btn').disabled = false;
            document.getElementById('stop-btn').disabled = true;
            logEvent('realtime', 'stop');

            if (realtimeInterval) {
                clearInterval(realtimeInterval);
                realtimeInterval = null;
            }
        };

        // Listen to chart events
        document.querySelectorAll('t-chart').forEach(chart => {
            chart.addEventListener('segment-click', (e) => {
                logEvent(chart.id || 'chart', 'segment-click', { label: e.detail.label, value: e.detail.value });
            });
        });

        logEvent('System', 'Demo initialized');
    </script>
    <script type="module" src="../js/utils/demo-color-picker.js"></script>
</body>
</html>
