<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TSplitterLit - Component Demo</title>

    <!-- Demo Template Styles -->
    <link rel="stylesheet" href="../css/demo-template.css">

    <style>
        .pane-content {
            padding: 20px;
            height: 100%;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .pane-content h3 {
            margin: 0 0 10px 0;
            color: var(--terminal-green);
            font-size: 14px;
            text-transform: uppercase;
        }

        .pane-content p {
            margin: 0;
            color: var(--terminal-gray);
            font-size: 12px;
        }

        .splitter-container {
            border: 1px solid var(--terminal-gray-dark);
            background: var(--terminal-gray-darkest);
        }

        .ide-pane {
            display: flex;
            flex-direction: column;
            height: 100%;
            box-sizing: border-box;
            overflow: hidden;
        }

        .ide-pane-header {
            padding: 8px 12px;
            font-size: 11px;
            text-transform: uppercase;
            color: var(--terminal-green);
            background: var(--terminal-gray-darkest);
            border-bottom: 1px solid var(--terminal-gray-dark);
            flex-shrink: 0;
        }

        .ide-pane t-tree {
            flex: 1;
            min-height: 0;
            overflow: auto;
        }

        .ide-pane t-textarea {
            flex: 1;
            min-height: 0;
            --textarea-min-height: 100%;
        }

        .file-explorer-pane,
        .editor-pane,
        .terminal-pane {
            padding: 0;
        }
    </style>
</head>
<body>
    <!-- Fixed Header -->
    <header class="demo-header">
        <div class="demo-header-content">
            <div class="demo-header-left">
                <h1>TSplitterLit</h1>
                <div class="breadcrumb">
                    <a href="index.html">← Components</a> / Splitter
                </div>
            </div>
            <div class="demo-header-controls">
                <button class="header-btn" id="toggleLogBtn">▼ Event Log</button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="demo-container">
        <div class="component-section">
            <h2 class="component-title">Splitter Component</h2>
            <p class="component-description">
                Resizable panel splitter with drag-to-resize, collapsible panes, and persistent state.
                <strong>All panes are collapsible by default:</strong> Double-click gutter to collapse, double-click again to restore.
            </p>

            <h3>Horizontal Splitter (Default)</h3>
            <div class="splitter-container" style="height: 250px;">
                <t-split id="basic-splitter">
                    <div slot="pane-0" class="pane-content">
                        <h3>Left Panel</h3>
                        <p>Double-click gutter to collapse this pane.</p>
                        <p>Drag to edge to collapse. Drag back to uncollapse.</p>
                    </div>
                    <div slot="pane-1" class="pane-content">
                        <h3>Right Panel</h3>
                        <p>Double-click on collapsed splitter to restore defaults.</p>
                        <p>All panes collapsible by default!</p>
                    </div>
                </t-split>
            </div>
            <span class="demo-label">Default 50/50 split - try double-click and drag-to-collapse</span>

            <h3>Vertical Splitter</h3>
            <div class="splitter-container" style="height: 300px;">
                <t-split id="vertical-splitter" orientation="vertical">
                    <div slot="pane-0" class="pane-content">
                        <h3>Top Panel</h3>
                        <p>Vertical orientation stacks panels top-to-bottom.</p>
                    </div>
                    <div slot="pane-1" class="pane-content">
                        <h3>Bottom Panel</h3>
                        <p>Drag the horizontal gutter to resize.</p>
                    </div>
                </t-split>
            </div>

            <h3>Custom Initial Sizes</h3>
            <div class="splitter-container" style="height: 200px;">
                <t-split id="custom-sizes" sizes="[30, 70]">
                    <div slot="pane-0" class="pane-content">
                        <h3>Sidebar (30%)</h3>
                        <p>Narrower sidebar panel.</p>
                    </div>
                    <div slot="pane-1" class="pane-content">
                        <h3>Main Content (70%)</h3>
                        <p>Wider main content area.</p>
                    </div>
                </t-split>
            </div>
            <span class="demo-label">30/70 split</span>

            <h3>Collapsible Panels</h3>
            <div class="controls" style="margin-bottom: 15px;">
                <button onclick="toggleCollapseLeft()">Toggle Left</button>
                <button onclick="toggleCollapseRight()">Toggle Right</button>
                <button onclick="resetCollapsible()">Reset</button>
            </div>
            <div class="splitter-container" style="height: 250px;">
                <t-split id="collapsible-splitter" collapsible="[true, true]">
                    <div slot="pane-0" class="pane-content">
                        <h3>Collapsible Left</h3>
                        <p>Click the arrows on the gutter or use the buttons above.</p>
                    </div>
                    <div slot="pane-1" class="pane-content">
                        <h3>Collapsible Right</h3>
                        <p>Both panels can be collapsed in this example.</p>
                    </div>
                </t-split>
            </div>

            <h3>IDE Layout Example</h3>
            <div class="splitter-container" style="height: 450px;">
                <t-split id="ide-main" sizes="[20, 80]" collapsible="[true, false]">
                    <div slot="pane-0" class="ide-pane file-explorer-pane">
                        <div class="ide-pane-header">File Explorer</div>
                        <t-tree id="file-tree" selectable="single" expand-on-click></t-tree>
                    </div>
                    <div slot="pane-1" style="height: 100%;">
                        <t-split id="ide-editor" orientation="vertical" sizes="[70, 30]" collapsible="[false, true]">
                            <div slot="pane-0" class="ide-pane editor-pane">
                                <div class="ide-pane-header">Editor - app.js</div>
                                <t-textarea id="code-editor" code-mode show-line-numbers language="javascript" rows="15"></t-textarea>
                            </div>
                            <div slot="pane-1" class="ide-pane terminal-pane">
                                <div class="ide-pane-header">Terminal</div>
                                <t-textarea id="terminal-output" code-mode rows="6" readonly></t-textarea>
                            </div>
                        </t-split>
                    </div>
                </t-split>
            </div>
            <span class="demo-label">Nested splitters with TTreeLit and syntax-highlighted editor</span>

            <h3>Minimum Sizes</h3>
            <div class="splitter-container" style="height: 200px;">
                <t-split id="min-sizes" min-sizes="[100, 150]">
                    <div slot="pane-0" class="pane-content">
                        <h3>Min 100px</h3>
                        <p>Can't resize smaller than 100px.</p>
                    </div>
                    <div slot="pane-1" class="pane-content">
                        <h3>Min 150px</h3>
                        <p>Can't resize smaller than 150px.</p>
                    </div>
                </t-split>
            </div>
            <span class="demo-label">Minimum sizes prevent over-collapsing</span>

            <h3>Custom Gutter Size</h3>
            <div class="demo-grid">
                <div class="demo-item">
                    <div class="splitter-container" style="height: 150px;">
                        <t-split gutter-size="4">
                            <div slot="pane-0" class="pane-content"><p>4px gutter</p></div>
                            <div slot="pane-1" class="pane-content"><p>Thin separator</p></div>
                        </t-split>
                    </div>
                    <span class="demo-label">Thin (4px)</span>
                </div>
                <div class="demo-item">
                    <div class="splitter-container" style="height: 150px;">
                        <t-split gutter-size="16">
                            <div slot="pane-0" class="pane-content"><p>16px gutter</p></div>
                            <div slot="pane-1" class="pane-content"><p>Wide separator</p></div>
                        </t-split>
                    </div>
                    <span class="demo-label">Wide (16px)</span>
                </div>
            </div>

            <h3>Programmatic Control</h3>
            <div class="controls" style="margin-bottom: 15px;">
                <button onclick="setSizes25_75()">Set 25/75</button>
                <button onclick="setSizes50_50()">Set 50/50</button>
                <button onclick="setSizes75_25()">Set 75/25</button>
            </div>
            <div class="splitter-container" style="height: 200px;">
                <t-split id="programmatic-splitter">
                    <div slot="pane-0" class="pane-content">
                        <h3>Left</h3>
                        <p>Use buttons to change sizes.</p>
                    </div>
                    <div slot="pane-1" class="pane-content">
                        <h3>Right</h3>
                        <p>Sizes are set programmatically.</p>
                    </div>
                </t-split>
            </div>

            <div class="code-block">
                <code>&lt;!-- Basic splitter --&gt;
&lt;t-split&gt;
  &lt;div slot="pane-0"&gt;Left&lt;/div&gt;
  &lt;div slot="pane-1"&gt;Right&lt;/div&gt;
&lt;/t-split&gt;

&lt;!-- Vertical orientation --&gt;
&lt;t-split orientation="vertical"&gt;...&lt;/t-split&gt;

&lt;!-- Custom sizes --&gt;
&lt;t-split sizes="[30, 70]"&gt;...&lt;/t-split&gt;

&lt;!-- Collapsible --&gt;
&lt;t-split collapsible="[true, true]"&gt;...&lt;/t-split&gt;

&lt;!-- Min sizes --&gt;
&lt;t-split min-sizes="[100, 150]"&gt;...&lt;/t-split&gt;

&lt;!-- JavaScript API --&gt;
&lt;script&gt;
  const splitter = document.querySelector('t-split');
  splitter.setSizes([25, 75]);
  splitter.toggleCollapse(0);
  splitter.reset();

  splitter.addEventListener('resize', (e) =&gt; {});
  splitter.addEventListener('collapse', (e) =&gt; {});
&lt;/script&gt;</code>
            </div>
        </div>
    </div>

    <!-- Floating Event Log -->
    <div class="event-log-container collapsed" id="eventLogContainer">
        <div class="event-log-toggle">
            <h3><span class="toggle-icon">▲</span> Event Log</h3>
            <div class="event-log-controls">
                <span class="event-log-count">0</span>
                <button class="event-log-clear">Clear</button>
            </div>
        </div>
        <div class="event-log" id="eventLog"></div>
    </div>

    <script type="module">
        import '../js/components/TSplitterLit.js';
        import '../js/components/TTreeLit.js';
        import '../js/components/TTextareaLit.js';

        // Event log functionality
        let eventCount = 0;
        const eventLog = document.getElementById('eventLog');
        const eventLogContainer = document.getElementById('eventLogContainer');
        const countEl = document.querySelector('.event-log-count');
        const toggleLogBtn = document.getElementById('toggleLogBtn');

        function logEvent(component, event, detail) {
            const entry = document.createElement('div');
            entry.className = 'event-entry';
            const timestamp = new Date().toLocaleTimeString();
            entry.textContent = `[${timestamp}] ${component}: ${event}${detail ? ' - ' + JSON.stringify(detail) : ''}`;
            eventLog.appendChild(entry);
            eventLog.scrollTop = eventLog.scrollHeight;
            eventCount++;
            countEl.textContent = eventCount;
        }

        // Toggle event log
        document.querySelector('.event-log-toggle').addEventListener('click', (e) => {
            if (e.target.closest('.event-log-clear')) return;
            eventLogContainer.classList.toggle('collapsed');
            toggleLogBtn.classList.toggle('active');
        });

        toggleLogBtn.addEventListener('click', () => {
            eventLogContainer.classList.toggle('collapsed');
            toggleLogBtn.classList.toggle('active');
        });

        // Clear log
        document.querySelector('.event-log-clear').addEventListener('click', (e) => {
            e.stopPropagation();
            eventLog.innerHTML = '';
            eventCount = 0;
            countEl.textContent = '0';
        });

        // IDE file tree data
        const fileTreeNodes = [
            {
                id: 'src',
                label: 'src',
                children: [
                    { id: 'src/index.js', label: 'index.js' },
                    { id: 'src/app.js', label: 'app.js' },
                    { id: 'src/utils.js', label: 'utils.js' }
                ]
            },
            {
                id: 'tests',
                label: 'tests',
                children: [
                    { id: 'tests/index.test.js', label: 'index.test.js' },
                    { id: 'tests/app.test.js', label: 'app.test.js' }
                ]
            },
            {
                id: 'docs',
                label: 'docs',
                children: [
                    { id: 'docs/README.md', label: 'README.md' }
                ]
            }
        ];

        const sampleCode = `// app.js
import { LitElement, html, css } from 'lit';

class MyApp extends LitElement {
  static tagName = 'my-app';

  static styles = css\`
    :host {
      display: block;
      padding: 20px;
    }
  \`;

  render() {
    return html\`
      <div class="container">
        <h1>Hello World</h1>
      </div>
    \`;
  }
}

export default MyApp;`;

        const terminalOutput = `$ npm run dev
Starting development server...
Server running at http://localhost:3000
✓ Ready in 245ms

$ _`;

        const fileTree = document.getElementById('file-tree');
        const codeEditor = document.getElementById('code-editor');
        const terminal = document.getElementById('terminal-output');

        if (fileTree) {
            fileTree.nodes = fileTreeNodes;
            fileTree.expanded = ['src', 'tests', 'docs'];
        }

        if (codeEditor) codeEditor.value = sampleCode;
        if (terminal) terminal.value = terminalOutput;

        // Listen to events on all splitters
        document.querySelectorAll('t-split').forEach(splitter => {
            splitter.addEventListener('resize', (e) => logEvent(splitter.id || 'splitter', 'resize', e.detail));
            splitter.addEventListener('resize-start', (e) => logEvent(splitter.id || 'splitter', 'resize-start', e.detail));
            splitter.addEventListener('resize-end', (e) => logEvent(splitter.id || 'splitter', 'resize-end', e.detail));
            splitter.addEventListener('collapse', (e) => logEvent(splitter.id || 'splitter', 'collapse', e.detail));
        });

        // Collapsible controls
        const collapsibleSplitter = document.getElementById('collapsible-splitter');
        window.toggleCollapseLeft = () => {
            collapsibleSplitter.toggleCollapse(0);
            logEvent('collapsible', 'toggle-left');
        };
        window.toggleCollapseRight = () => {
            collapsibleSplitter.toggleCollapse(1);
            logEvent('collapsible', 'toggle-right');
        };
        window.resetCollapsible = () => {
            collapsibleSplitter.reset();
            logEvent('collapsible', 'reset');
        };

        // Programmatic size controls
        const programmaticSplitter = document.getElementById('programmatic-splitter');
        window.setSizes25_75 = () => {
            programmaticSplitter.setSizes([25, 75]);
            logEvent('programmatic', 'set-sizes', { sizes: [25, 75] });
        };
        window.setSizes50_50 = () => {
            programmaticSplitter.setSizes([50, 50]);
            logEvent('programmatic', 'set-sizes', { sizes: [50, 50] });
        };
        window.setSizes75_25 = () => {
            programmaticSplitter.setSizes([75, 25]);
            logEvent('programmatic', 'set-sizes', { sizes: [75, 25] });
        };

        logEvent('System', 'Demo initialized');
    </script>
    <script type="module" src="../js/utils/demo-color-picker.js"></script>
</body>
</html>
